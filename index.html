<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MegaherzCampus PWA TEST</title>
  <link rel="manifest" href="manifest.json" />
  <style>
    body {
      font-family: 'Comic Sans MS', cursive, sans-serif;
      margin: 0;
      padding: 0;
      background: url('images/background.jpg') no-repeat center center fixed;
      background-size: cover;
      text-align: center;
      color: #000;
    }

    header {
      background: rgba(0,120,215,0.85);
      color: white;
      padding: 1rem;
      font-size: 1.4rem;
      font-weight: bold;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
    }

    .page {
      display: none;
      padding: 20px;
      min-height: calc(100vh - 70px);
      background: rgba(255,255,255,0.7);
      border-radius: 20px;
      margin: 15px auto;
      max-width: 700px;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
    }

    .active { display: block; }

    button {
      padding: 15px 25px;
      margin: 10px;
      border: none;
      background: #ffb400;
      color: white;
      border-radius: 12px;
      cursor: pointer;
      font-size: 1.2rem;
      font-weight: bold;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      transition: transform 0.2s, background 0.3s;
    }

    button:hover { 
      transform: scale(1.05);
      background: #ffc933;
    }

    #game-area {
      position: relative;
      width: 95%;
      max-width: 700px;
      aspect-ratio: 2 / 1;
      margin: 20px auto;
      background: rgba(223, 240, 216, 0.85) url('images/treasure-map.png') center/cover;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }

    #character {
      position: absolute;
      width: 9%;
      aspect-ratio: 1 / 1;
      background: url('images/character.png') no-repeat center/contain;
      transition: left 1.5s ease-in-out, top 1.5s ease-in-out;
    }

    .checkpoint {
      position: absolute;
      width: 9%;
      aspect-ratio: 1 / 1;
      background: gold;
      border-radius: 50%;
      text-align: center;
      font-weight: bold;
      color: #000;
      line-height: 180%;
      box-shadow: 0 0 8px rgba(0,0,0,0.3);
    }

    /* Dynamically positioned checkpoints (aligned to your uploaded map path) */
    #A { top: 68%; left: 5%; }   /* near the bottle bottom left */
    #B { top: 55%; left: 23%; }  /* near the octopus */
    #C { top: 27%; left: 45%; }  /* near the palm island */
    #D { top: 35%; left: 65%; }  /* near the shark/volcano */
    #E { top: 70%; left: 80%; }  /* near the treasure */
    #F { top: 38%; left: 90%; }  /* near the parrot side */

    #goldDisplay {
      font-size: 1.4rem;
      margin-top: 10px;
      font-weight: bold;
    }

    #questionBox {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
      width: 80%;
      max-width: 400px;
      text-align: center;
      z-index: 100;
    }

    #questionBox h3 {
      font-size: 1.6rem;
      margin-bottom: 20px;
    }

    #questionBox input {
      font-size: 1.3rem;
      padding: 10px;
      width: 60%;
      border-radius: 8px;
      border: 2px solid #0078d7;
      text-align: center;
    }

    #overlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 90;
    }

    #pdfList a {
      display: block;
      margin: 5px 0;
      color: #0078d7;
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>üè¥‚Äç‚ò†Ô∏è MegaherzCampus Treasure Hunt</header>

  <!-- HOME PAGE -->
  <div id="home" class="page active">
    <h2>Welcome to MegaherzCampus!</h2>
    <p>Choose an activity:</p>
    <button onclick="showPage('documents')">üìÑ Download Documents</button>
    <button onclick="showPage('game')">üèùÔ∏è Play Treasure Hunt</button>
  </div>

  <!-- DOCUMENTS PAGE -->
  <div id="documents" class="page">
    <h2>üìÑ Downloadable Documents</h2>
    <ul id="pdfList"></ul>
    <button onclick="showPage('home')">‚¨ÖÔ∏è Back</button>
  </div>

  <!-- GAME PAGE -->
  <div id="game" class="page">
    <h2>üèùÔ∏è MegaherzCampus Treasure Hunt</h2>
    <div id="goldDisplay">üí∞ Gold: 0</div>
    <div id="game-area">
      <div id="character"></div>
      <div id="A" class="checkpoint">A</div>
      <div id="B" class="checkpoint">B</div>
      <div id="C" class="checkpoint">C</div>
      <div id="D" class="checkpoint">D</div>
      <div id="E" class="checkpoint">E</div>
      <div id="F" class="checkpoint">F</div>
    </div>
    <button onclick="startGame()">Start Game</button>
    <button onclick="showPage('home')">‚¨ÖÔ∏è Back</button>
  </div>

  <!-- QUESTION POPUP -->
  <div id="overlay"></div>
  <div id="questionBox">
    <h3 id="questionText">Question</h3>
    <input type="text" id="answerInput" placeholder="Your answer" />
    <br><br>
    <button onclick="submitAnswer()">Submit</button>
  </div>

  <script>
  // ===== PAGE NAVIGATION =====
  function showPage(id){
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  }

  // ===== PDF DOWNLOAD =====
  const pdfs = [
    { name: "Sample Document 1", url: "docs/sample1.pdf" },
    { name: "Sample Document 2", url: "docs/sample2.pdf" }
  ];

  function renderPDFs() {
    const list = document.getElementById('pdfList');
    list.innerHTML = '';
    pdfs.forEach(p => {
      const li = document.createElement('li');
      const a = document.createElement('a');
      a.textContent = p.name;
      a.href = p.url;
      a.download = p.name;
      li.appendChild(a);
      list.appendChild(li);
    });
  }
  renderPDFs();

  // ===== GAME LOGIC =====
  let goldCount = 0;
  const goldDisplay = document.getElementById('goldDisplay');
  const character = document.getElementById('character');
  const checkpoints = ['A','B','C','D','E','F'];
  let currentIndex = 0;
  let correctAnswer = '';

  function generateQuestion() {
    const num1 = Math.floor(Math.random() * 10) + 1;
    const num2 = Math.floor(Math.random() * 10) + 1;
    const isAdd = Math.random() > 0.5;
    const question = isAdd ? `${num1} + ${num2} = ?` : `${Math.max(num1,num2)} - ${Math.min(num1,num2)} = ?`;
    correctAnswer = isAdd ? (num1+num2).toString() : (Math.max(num1,num2)-Math.min(num1,num2)).toString();
    document.getElementById('questionText').textContent = question;
    const input = document.getElementById('answerInput');
    input.value = '';
    input.style.backgroundColor = 'white';
  }

  function showQuestion() {
    generateQuestion();
    document.getElementById('overlay').style.display = 'block';
    document.getElementById('questionBox').style.display = 'block';
  }

  function hideQuestion() {
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('questionBox').style.display = 'none';
  }

  function addGoldAnimation() {
    const goldIcon = document.createElement('div');
    goldIcon.textContent = 'üí∞';
    goldIcon.style.position = 'absolute';
    goldIcon.style.top = '50%';
    goldIcon.style.left = '50%';
    goldIcon.style.transform = 'translate(-50%, -50%) scale(1)';
    goldIcon.style.fontSize = '2rem';
    goldIcon.style.opacity = '1';
    goldIcon.style.transition = 'transform 0.8s ease-out, opacity 0.8s ease-out';
    document.body.appendChild(goldIcon);

    setTimeout(() => {
      goldIcon.style.transform = 'translate(-50%, -200%) scale(0.5)';
      goldIcon.style.opacity = '0';
    }, 100);

    setTimeout(() => goldIcon.remove(), 900);
  }

  function submitAnswer() {
    const input = document.getElementById('answerInput');
    const answer = input.value.trim();

    if (answer === correctAnswer) {
      input.style.backgroundColor = '#b4f8b4';
      goldCount++;
      goldDisplay.textContent = `üí∞ Gold: ${goldCount}`;
      addGoldAnimation();
    } else {
      input.style.backgroundColor = '#ffb3b3';
    }

    setTimeout(() => {
      hideQuestion();
      moveToCheckpoint(currentIndex + 1);
    }, 1000);
  }

  function startGame() {
    goldCount = 0;
    currentIndex = 0;
    goldDisplay.textContent = 'üí∞ Gold: 0';
    character.style.left = '0%';
    character.style.top = '70%';
    moveToCheckpoint(0);
  }

  function moveToCheckpoint(index){
    if(index >= checkpoints.length){
      setTimeout(()=>alert(`üèÜ Game over! You collected ${goldCount} gold!`),500);
      return;
    }
    currentIndex = index;
    const cp = document.getElementById(checkpoints[index]);
    character.style.left = cp.offsetLeft + 'px';
    character.style.top = cp.offsetTop + 'px';
    setTimeout(showQuestion, 1300);
  }

  // ===== PWA SERVICE WORKER =====
  if('serviceWorker' in navigator){
    navigator.serviceWorker.register('sw.js');
  }
  </script>
</body>
</html>
